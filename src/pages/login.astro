---
import Layout from '../layouts/Layout.astro';
---

<Layout title="–í—Ö–æ–¥ –≤ —Å–∏—Å—Ç–µ–º—É - Restaurant Checklist">
	<div class="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center p-4">
		<div class="max-w-md w-full bg-white rounded-xl shadow-lg p-8">
			<div class="text-center mb-8">
				<h1 class="text-3xl font-bold text-gray-800 mb-2">üçΩÔ∏è Restaurant System</h1>
				<p class="text-gray-600">–í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—à—É —Ä–æ–ª—å –¥–ª—è –≤—Ö–æ–¥–∞ –≤ —Å–∏—Å—Ç–µ–º—É</p>
			</div>

			<div class="space-y-4">
				<!-- Chef Role -->
				<button onclick="selectRole('chef')" class="w-full bg-orange-500 hover:bg-orange-600 text-white font-medium py-4 px-6 rounded-lg transition-colors duration-200 flex items-center justify-center">
					<span class="text-2xl mr-3">üë®‚Äçüç≥</span>
					<div class="text-left">
						<div class="font-semibold">–ü–æ–≤–∞—Ä</div>
						<div class="text-sm opacity-90">–ó–∞–∫–∞–∑—ã –¥–ª—è –∫—É—Ö–Ω–∏</div>
					</div>
				</button>

				<!-- Barman Role -->
				<button onclick="selectRole('barman')" class="w-full bg-purple-500 hover:bg-purple-600 text-white font-medium py-4 px-6 rounded-lg transition-colors duration-200 flex items-center justify-center">
					<span class="text-2xl mr-3">üç∑</span>
					<div class="text-left">
						<div class="font-semibold">–ë–∞—Ä–º–µ–Ω</div>
						<div class="text-sm opacity-90">–ó–∞–∫–∞–∑—ã –¥–ª—è –±–∞—Ä–∞</div>
					</div>
				</button>

				<!-- Manager Role -->
				<button onclick="selectRole('manager')" class="w-full bg-green-500 hover:bg-green-600 text-white font-medium py-4 px-6 rounded-lg transition-colors duration-200 flex items-center justify-center">
					<span class="text-2xl mr-3">üë®‚Äçüíº</span>
					<div class="text-left">
						<div class="font-semibold">–ú–µ–Ω–µ–¥–∂–µ—Ä</div>
						<div class="text-sm opacity-90">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞–º–∏</div>
					</div>
				</button>

				<!-- Admin Role -->
				<button onclick="selectRole('admin')" class="w-full bg-red-500 hover:bg-red-600 text-white font-medium py-4 px-6 rounded-lg transition-colors duration-200 flex items-center justify-center">
					<span class="text-2xl mr-3">‚öôÔ∏è</span>
					<div class="text-left">
						<div class="font-semibold">–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä</div>
						<div class="text-sm opacity-90">–ü–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø</div>
					</div>
				</button>
			</div>

			<div class="mt-8 text-center">
				<p class="text-sm text-gray-500">–†–æ–ª—å —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –¥–æ –≤—ã—Ö–æ–¥–∞ –∏–∑ —Å–∏—Å—Ç–µ–º—ã</p>
				<button onclick="clearRole()" class="mt-2 text-sm text-blue-600 hover:text-blue-800 underline">
					–°–±—Ä–æ—Å–∏—Ç—å —Ä–æ–ª—å
				</button>
			</div>
		</div>
	</div>

	<script is:inline>
		function selectRole(role) {
			// Save role to localStorage
			localStorage.setItem('userRole', role);
			localStorage.setItem('userRoleTimestamp', Date.now().toString());
			
			// Show confirmation
			const roleNames = {
				chef: '–ü–æ–≤–∞—Ä üë®‚Äçüç≥',
				barman: '–ë–∞—Ä–º–µ–Ω üç∑',
				manager: '–ú–µ–Ω–µ–¥–∂–µ—Ä üë®‚Äçüíº',
				admin: '–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä ‚öôÔ∏è'
			};
			
			alert(`‚úÖ –í—ã –≤–æ—à–ª–∏ –∫–∞–∫: ${roleNames[role]}`);
			
			// Redirect to appropriate page
			if (role === 'admin') {
				window.location.href = '/settings';
			} else if (role === 'manager') {
				window.location.href = '/manager-dashboard';
			} else if (role === 'chef') {
				window.location.href = '/kitchen-inventory';
			} else if (role === 'barman') {
				window.location.href = '/bar-inventory';
			} else {
				window.location.href = '/';
			}
		}

		function clearRole() {
			localStorage.removeItem('userRole');
			localStorage.removeItem('userRoleTimestamp');
			alert('üîÑ –†–æ–ª—å —Å–±—Ä–æ—à–µ–Ω–∞');
			location.reload();
		}

		// Check if user already has a role
		document.addEventListener('DOMContentLoaded', () => {
			const currentRole = localStorage.getItem('userRole');
			const roleTimestamp = localStorage.getItem('userRoleTimestamp');
			
			// Auto-expire role after 8 hours
			if (currentRole && roleTimestamp) {
				const eightHours = 8 * 60 * 60 * 1000;
				if (Date.now() - parseInt(roleTimestamp) > eightHours) {
					clearRole();
					return;
				}
				
				// If role is still valid, show current role
				const roleNames = {
					chef: '–ü–æ–≤–∞—Ä üë®‚Äçüç≥',
					barman: '–ë–∞—Ä–º–µ–Ω üç∑',
					manager: '–ú–µ–Ω–µ–¥–∂–µ—Ä üë®‚Äçüíº',
					admin: '–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä ‚öôÔ∏è'
				};
				
				const currentRoleDiv = document.createElement('div');
				currentRoleDiv.className = 'mb-6 p-4 bg-blue-50 border border-blue-200 rounded-lg text-center';
				currentRoleDiv.innerHTML = `
					<p class="text-blue-800 font-medium">–¢–µ–∫—É—â–∞—è —Ä–æ–ª—å: ${roleNames[currentRole]}</p>
					<button onclick="continueAsCurrentRole()" class="mt-2 bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg text-sm">
						–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å
					</button>
				`;
				
				document.querySelector('.space-y-4').parentNode.insertBefore(currentRoleDiv, document.querySelector('.space-y-4'));
			}
		});

		function continueAsCurrentRole() {
			const role = localStorage.getItem('userRole');
			selectRole(role);
		}
	</script>
</Layout>
