---
export const prerender = false;
---

<script is:inline>
// Parse cart data from URL and import it
document.addEventListener('DOMContentLoaded', function() {
    const urlParams = new URLSearchParams(window.location.search);
    const cartData = urlParams.get('data');
    
    if (cartData) {
        try {
            const decodedData = JSON.parse(decodeURIComponent(cartData));
            
            // Import cart data to localStorage
            Object.keys(decodedData).forEach(department => {
                const items = decodedData[department];
                if (items && items.length > 0) {
                    const storageKey = `${department}ShoppingList`;
                    localStorage.setItem(storageKey, JSON.stringify(items));
                    console.log(`üì• Imported ${items.length} items for ${department}`);
                }
            });
            
            // Show success message and redirect
            alert(`‚úÖ –ö–æ—Ä–∑–∏–Ω–∞ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–∞!\n–ó–∞–≥—Ä—É–∂–µ–Ω–æ —Ç–æ–≤–∞—Ä–æ–≤ –∏–∑ ${Object.keys(decodedData).length} –æ—Ç–¥–µ–ª–æ–≤.`);
            
            // Redirect to cart page
            window.location.href = '/cart';
            
        } catch (error) {
            console.error('‚ùå Failed to import cart:', error);
            alert('‚ùå –û—à–∏–±–∫–∞ –∏–º–ø–æ—Ä—Ç–∞ –∫–æ—Ä–∑–∏–Ω—ã');
            window.location.href = '/';
        }
    } else {
        // No cart data in URL, redirect to home
        window.location.href = '/';
    }
});
</script>
